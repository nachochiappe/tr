{% extends 'base.html' %}

{% block content %}
    <div>
    <h2>Detalle de Paciente</h2>

    <dl class="row">
        <dt class="col-sm-3">Nombre</dt>
        <dd class="col-sm-9">{{ object.paciente.nombre }}</dd>
        <dt class="col-sm-3">Apellido</dt>
        <dd class="col-sm-9">{{ object.paciente.apellido }}</dd>
        <dt class="col-sm-3">DNI</dt>
        <dd class="col-sm-9">{{ object.paciente.dni }}</dd>
        <dt class="col-sm-3">Fecha de Nacimiento</dt>
        <dd class="col-sm-9">{{ object.paciente.fecnac }}</dd>
        <dt class="col-sm-3">País</dt>
        <dd class="col-sm-9">{{ object.paciente.pais }}</dd>
        <dt class="col-sm-3">Mail</dt>
        <dd class="col-sm-9">{{ object.paciente.mail }}</dd>
    </dl>
    </div>

{% if request.user.is_staff %}
    <div>
        <button type="button" class="btn btn-info btn-sm">Editar Datos</button>
        <button type="button" class="btn btn-danger btn-sm">Eliminar Paciente</button>
        </br></br>
    </div>
{% endif %}

    <div id="accordion" role="tablist">
        <div class="card">
            <div class="card-header" role="tab" id="headingOne">
                <h5 class="mb-0">
                    <a data-toggle="collapse" href="#medicamentos" role="button" aria-expanded="true" aria-controls="medicamentos">
                        Medicamentos
                    </a>
                </h5>
            </div>

            <div id="medicamentos" class="collapse" role="tabpanel" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="card-body">
                    <h5>Medicaciones Actuales</h5></br>
                    <input type="button" class="btn btn-success btn-sm" id="addrow" value="+ Nueva Medicación"></br></br>

                    <form method="POST" id="form_medicamento">{% csrf_token %}</form>

                    <table class="table table-sm table-hover medact">
                        <thead class="thead-light">
                            <tr>
                                <th scope="col">Medicamento</th>
                                <th scope="col">Posología</th>
                                <th scope="col">Recetado Por</th>
                                <th scope="col">Fecha Inicio</th>
                                <th scope="col">Fecha Fin</th>
                                <th scope="col">Cantidad de dosis completadas</th>
                                <th scope="col">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for medicamento in object.medicamentos %}
                            <tr>
                                <th scope="row">{{ medicamento.medicamento }}</th>
                                <td>{{ medicamento.posologia }}</td>
                                <td>{{ medicamento.medico.apellido }}, {{ medicamento.medico.nombre }}</td>
                                <td>{{ medicamento.fecha_inicio }}</td>
                                <td>{{ medicamento.fecha_fin }}</td>
                                <td>{{ medicamento.dosis_completadas }}</td>
                                <td><input type="button" class="ibtnEdit btn btn-sm btn-info" value="Editar">
                                    <input type="button" class="ibtnBorrar btn btn-sm btn-danger" value="Borrar"></td>
                            </tr>
                            {% endfor %}
                      </tbody>
                    </table>


                     <h5>Medicaciones Pasadas</h5></br>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" role="tab" id="headingTwo">
                <h5 class="mb-0">
                    <a data-toggle="collapse" href="#estudiosyactividades" role="button" aria-expanded="true" aria-controls="estudiosyactividades">
                        Estudios y Actividades
                    </a>
                </h5>
            </div>

            <div id="estudiosyactividades" class="collapse" role="tabpanel" aria-labelledby="headingTwo" data-parent="#accordion">
                <div class="card-body">
                    <button type="button" class="btn btn-success btn-sm">+ Nuevo Estudio o Actividad</button>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header" role="tab" id="headingThree">
                <h5 class="mb-0">
                    <a data-toggle="collapse" href="#acciones" role="button" aria-expanded="true" aria-controls="acciones">
                        Acciones
                    </a>
                </h5>
            </div>

            <div id="acciones" class="collapse" role="tabpanel" aria-labelledby="headingThree" data-parent="#accordion">
                <div class="card-body">
                    <div class="list-group">
                        <a class="list-group-item list-group-item-action">Derivar paciente</a>
                        <a class="list-group-item list-group-item-action">Enviar correo electrónico al paciente</a>
                        <a class="list-group-item list-group-item-action">Enviar mensaje (dentro de TR)</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}